import { createIndexSizeError } from 'standardized-audio-context/src/factories/index-size-error';
import { TNativeAudioBuffer } from 'standardized-audio-context/src/types/index';

export const wrapAudioBufferGetChannelDataMethod = (audioBuffer: TNativeAudioBuffer): void => {
    audioBuffer.getChannelData = ((getChannelData) => {
        return (channel: number) => {
            try {
                return getChannelData.call(audioBuffer, channel);
            } catch (err) {
                if (err.code === 12) {
                    throw createIndexSizeError();
                }

                throw err;
            }
        };
    })(audioBuffer.getChannelData);
};
